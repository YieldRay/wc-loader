<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>landsoul-layout</title>
    <link href="https://unpkg.com/landsoul" rel="stylesheet" adopted />
    <link href="https://unpkg.com/landsoul/dist/extra.css" rel="stylesheet" adopted />
    <script type="module" src="https://esm.sh/interestfor"></script>
    <script type="module" src="https://esm.sh/invokers-polyfill"></script>
    <style global>
      :root,
      body {
        height: 100%;
        overflow: hidden;
        margin: 0;
      }
    </style>
    <style>
      :host,
      #root {
        display: block;
        height: 100%;
        overflow: hidden;
      }
      #root {
        display: grid;
        grid-template:
          "header header" min-content
          "main main" 1fr
          "footer footer" auto
          / 1fr;

        @media (width >= 720px) {
          height: 100vh;
          overflow: hidden;
          grid-template:
            "header header header" min-content
            "nav main main" 1fr
            "footer footer footer" auto
            / auto 1fr 1fr;

          /* hide the menu button in wide screen */
          [popovertarget="menu"] {
            display: none;
          }

          nav#menu {
            all: unset; /* disable the popover behavior, make nav a regular element */
            grid-area: nav;
            box-sizing: border-box;
            width: 320px;
            padding: 1rem;
            display: flex;
            flex-direction: column;
            overflow-y: auto;
            border-right: solid 1px var(--landsoul-surface);
            color: var(--landsoul-text);
            background-color: var(--landsoul-bg);
          }
        }
      }

      .header {
        grid-area: header;
        display: flex;
        align-items: center;
        gap: 1rem;
        padding: 0.5rem 1rem;
        border-bottom: solid 1px var(--landsoul-surface);

        @media (width < 720px) {
          position: sticky;
          top: 0;
          background-color: var(--landsoul-bg);
          z-index: 10;
        }

        .title {
          font-weight: 500;
          margin: 0;
          padding: 0;
        }
      }

      .main {
        grid-area: main;
        padding: 1rem;
        scrollbar-gutter: stable;
        overflow-y: auto;
      }

      .footer {
        grid-area: footer;
        padding: 1rem;
        border-top: solid 1px var(--landsoul-surface);
        display: flex;
        flex-wrap: wrap;
        gap: 1rem;
        align-items: center;
        justify-content: space-between;
      }

      .space-between {
        display: flex;
        justify-content: space-between;
      }

      .inline-full {
        box-sizing: border-box;
        inline-size: 100%;
      }
    </style>
  </head>
  <body>
    <div id="root">
      <!-- Navigation: popover on compact, sidebar on wide -->
      <nav id="menu" class="landsoul-drawer-left" popover="auto">
        <span>
          <slot name="menu"></slot>
        </span>
      </nav>

      <header class="header space-between">
        <div class="space-between" style="gap: 1rem">
          <button popovertarget="menu" popovertargetaction="show">
            <svg width="15" height="15" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path
                d="M1.5 3C1.22386 3 1 3.22386 1 3.5C1 3.77614 1.22386 4 1.5 4H13.5C13.7761 4 14 3.77614 14 3.5C14 3.22386 13.7761 3 13.5 3H1.5ZM1 7.5C1 7.22386 1.22386 7 1.5 7H13.5C13.7761 7 14 7.22386 14 7.5C14 7.77614 13.7761 8 13.5 8H1.5C1.22386 8 1 7.77614 1 7.5ZM1 11.5C1 11.2239 1.22386 11 1.5 11H13.5C13.7761 11 14 11.2239 14 11.5C14 11.7761 13.7761 12 13.5 12H1.5C1.22386 12 1 11.7761 1 11.5Z"
                fill="currentColor"
                fill-rule="evenodd"
                clip-rule="evenodd"
              ></path>
            </svg>
          </button>

          <h6 class="title"><slot name="header-title"></slot></h6>
        </div>

        <aside>
          <slot name="header-aside"></slot>
        </aside>
      </header>

      <section class="main">
        <slot></slot>
      </section>

      <footer class="footer">
        <slot name="footer"></slot>
      </footer>
    </div>
  </body>

  <script type="module">
    import { defineComponent } from "../../dist/index.bundled.js";
    // Close popover when switching to wide layout to prevent top-layer promotion

    defineComponent((document) => {
      matchMedia("(width >= 720px)").onchange = (e) => {
        if (e.matches) {
          document.getElementById("menu").hidePopover();
        }
      };
    });
  </script>
</html>
